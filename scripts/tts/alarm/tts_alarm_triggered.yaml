---
# tts_pokeme
#
# TTS message saying some is trying to contact us.
# Used by automation "notify_pokeme"
#
tts_alarm_triggered:
  sequence:
    - service: script.tts_processing
      data:
        message: "Alarme activée. Dans 5 secondes, l'alarme sera declenchée. Quitter les lieux, ou désactiver l'alarme."
    - delay: 5
    - wait_template: "{{ is_state('media_player.living', 'idle') }}"
    - repeat:
        while:
          - condition: state
            entity_id: alarm_control_panel.alarme
            state: "triggered"
        sequence:
          - service: media_player.play_media
            entity_id: media_player.l_appartement
            data:
              media_content_id: "http://192.168.1.10:8123/local/alarm.wav"
              media_content_type: music
          - delay: 5
          - wait_template: "{{ is_state('media_player.living', 'idle') }}"
          - service: script.tts_processing
            data:
              message: "Alarme déclenchée. Propriétaire prévenu. Police prévenue. Quitter les lieux."
          - delay: 5
          - wait_template: "{{ is_state('media_player.living', 'idle') }}"
